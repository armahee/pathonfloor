<!DOCTYPE html>
<html>
<head>
	<title>AR Mahee Project</title>
	<style type="text/css">
		body {
			background-color: #000;
			margin: 0px;
		}
		#header {
			position: absolute;
			width: 400px;
			background-color: white;
			padding: 20px;
		}
		#bdy {
			left: 500px;
			position: absolute;
			width: 62%
		}
		.door {
			position: absolute;
			border-radius: 5px;
			background: red;
		}
		.vpath {
			width: 0px;
			height: 5px;
		}
		.hpath {
			width: 5px;
			height: 0px;
		}
		#f0rm7 {
			top: 445px;
			left: 245px;
		}
		#f0rm10 {
			top: 445px;
			left: 265px;
		}
		#f0rm18 {
			top: 445px;
			left: 391px;
		}
		#f0rm20 {
			top: 410px;
			left: 391px;
		}
		#f0rm21 {
			top: 395px;
			left: 391px;
		}

	</style>
</head>
<body>
<div id='header'>
	<label for="flr">Choose a floor:</label>
	<select id='flr' onchange="changeFloor()">
		<option selected="" value="">Select a floor</option>
		<option value="0">Ground Floor</option>
		<option value="1">Lower First Floor</option>
		<option value="2">First Floor</option>
		<option value="3">Second Floor</option>
	</select><br><br>
	<pre id='display'></pre>
</div>
<div id='bdy'>
	<img id="imgLoader" src="">
</div>
<script type="text/javascript">
	//document.getElementById("srm").addEventListener("change",startRoom,false);

	/* Function to return the DOM object's in crossbrowser style */
	function heightCrossBrowser(element) {
	    /* element - DOM element */

	    /* For FireFox & IE */
	    if(     element.height != undefined && element.height != '' && element.height != 0){
	        this.height  =   element.height;
	    }
	    /* For FireFox & IE */
	    else if(element.clientHeight != undefined && element.clientHeight != '' && element.clientHeight != 0){
	        this.height  =   element.clientHeight;
	    }
	    /* For Chrome * FireFox */
	    else if(element.naturalHeight != undefined && element.naturalHeight != '' && element.naturalHeight != 0){
	        this.height  =   element.naturalHeight;
	    }
	    /* For FireFox & IE */
	    else if(element.offsetHeight != undefined && element.offsetHeight != '' && element.offsetHeight != 0){
	        this.height  =   element.offsetHeight;
	    }       
	        /*
	            console.info(' widthWidth height:',      element.height);
	            console.info(' clntWidth clientHeight:', element.clientHeight);
	            console.info(' natWidth naturalHeight:', element.naturalHeight);
	            console.info(' offstWidth offsetHeight:',element.offsetHeight);       
	            console.info(' parseInt(this.height):',parseInt(this.height));
	        */
	    return parseInt(this.height);

	}
	function sleep(ms) {
	  return new Promise(resolve => setTimeout(resolve, ms));
	}
	console.log('working');
	var straitLine_i = 0, drawIsRunning, imgScale = 600, pathScale = 1, floorNum, arrayFl, arrayGr;//, shortpath = 999999;
	async function drawSLine(fromX, fromY, toX, toY) {
		fromX = fromX / pathScale;
		fromY = fromY / pathScale;
		toX = toX / pathScale;
		toY = toY / pathScale;
		var info = document.createElement('div');
		info.style.position = 'absolute';
		info.style.borderRadius = '5px';
		info.style.left = fromX+'px';
		info.style.top = fromY+'px';
		info.style.backgroundColor = 'red';
		info.style.zIndex = '1';
		info.id = 'straitLine'+straitLine_i;
		document.getElementById('bdy').appendChild(info);
		if(fromX == toX){
			if(toY > fromY){
				info.style.width = '5px';
				info.style.height = '0px';
				for (var i = 1; i <= toY - (fromY - 5); i++) {
					info.style.height = i.toString()+"px";
					await sleep(5);
				}
			}
			else if(toY < fromY){
				info.style.top = (fromY+5)+'px';
				info.style.width = '5px';
				info.style.height = '0px';
				for (var i = 1; i <= (fromY - toY)+5; i++) {
					info.style.top = (parseInt(info.style.top, 10) - 1)+'px';
					info.style.height = i.toString()+'px';
					await sleep(5);
				}
			}
			else{
				info.style.width = '5px';
				info.style.height = '5px';
			}
		}
		else if(fromY == toY){
			if(toX > fromX){
				info.style.width = '0px';
				info.style.height = '5px';
				for (var i = 1; i <= toX - (fromX - 5); i++) {
					info.style.width = i.toString()+'px';
					await sleep(5);
				}
			}
			else if(toX < fromX){
				info.style.left = (fromX+5)+'px';
				info.style.width = '0px';
				info.style.height = '5px';
				for (var i = 1; i <= (fromX - toX)+4; i++) {
					info.style.left = (parseInt(info.style.left, 10) - 1)+'px';
					info.style.width = i.toString()+'px';
					await sleep(5);
				}
			}
			else{
				info.style.width = '5px';
				info.style.height = '5px';
			}
		}
		else{
			console.log(fromX+','+fromY+' | '+toX+','+toY);
			alert('Sorry! Unable to draw Strait Line');
		}
		//animate(info.id, toX, toY);
	}

	function removeLines() {
		var linepar = document.getElementById('bdy');
		while(straitLine_i){
			straitLine_i--;
			linepar.removeChild(document.getElementById('straitLine'+straitLine_i));
		}
	}

	function pathDist(srmv, ermv) {
		if(points[floorNum][srmv][0] == points[floorNum][ermv][0]){
			return Math.abs(points[floorNum][srmv][1]-points[floorNum][ermv][1]);
		}
		else if(points[floorNum][srmv][1] == points[floorNum][ermv][1]){
			return Math.abs(points[floorNum][srmv][0]-points[floorNum][ermv][0]);
		}
		else{
			alert('There is a problem with graph. Nodes are not connected!');
			return -1;
		}
	}
	/*drawSLine(160, 10, 590, 10);
	straitLine_i ++;
	drawSLine(590, 10, 590, 485);
	straitLine_i ++;
	drawSLine(595, 485, 165, 485);
	straitLine_i ++;
	drawSLine(160, 490, 160, 10);
	straitLine_i ++;
	setTimeout(removeLines, 3000);*/
	var img = [
		'groundFloor.jpg',
		'lowerFloor.jpg',
		'firstFloor.jpg',
		'secondFloor.jpg'
	];
	var menu = [
		[
			[0,'Loading Bay'],
			[38,'Main Entrance'],
			[4,'LIFT'],
			[68,'Disabled Lift'],
			[5,'Stairs(Besides Loading Bay)'],
			[39,'Stairs(Besides Main Entrance)'],
			[31,'Male Toilet(Besides G105 IT Services)'],
			[64,'Male Toilet(Besides G23 Computr Cluster)'],
			[24,'Female Toilet'],
			[28,'Disabled Toilet'],
			[8,'IT Services Right(Besides Loading Bay)'],
			[9,'IT Services Left(Besides Loading Bay)'],
			[36,'IT Services(Besides Main Entrance)'],
			[12,'G105 IT Services'],
			[32,'IT Services Helpdesk'],
			[41,'G6'],
			[43,'G7'],
			[45,'G10'],
			[47,'G11'],
			[49,'G12'],
			[51,'G13'],
			[54,'G14'],
			[55,'G16'],
			[56,'G18'],
			[58,'G20'],
			[60,'G21'],
			[66,'G23 Computer Cluster'],
			[18,'G33 Research Lab'],
			[62,'G33a'],
			[20,'G35'],
			[69,'G36'],
			[22,'G37'],
			[15,'G41 Collaborative Space']
		],
		[
			[0,'LIFT'],
			[5,'Stairs(Besides Disabled LIFT)'],
			[8,'Stairs(Besides LF29)'],
			[10,'LF29'],
			[12,'LF28'],
			[14,'LF27'],
			[17,'LF26'],
			[19,'LF25'],
			[21,'LF24'],
			[23,'LF23'],
			[25,'Stairs(Besides Student Support Office)'],
			[28,'LF22'],
			[30,'Student Support Office'],
			[32,'LF21 Student Resource Centre'],
			[35,'LF17 PGR Space'],
			[37,'LF15 PGR Lab'],
			[41,'LF31 Computer Cluster'],
			[45,'LF34 Collab 2'],
			[49,'Vending'],
			[46,'LF39 Collab 1'],
			[52,'LF16 Tootill 1 Computer Cluster'],
			[55,'LF9 Tootill 0 Computer Cluster'],
			[75,'LF10'],
			[76,'LF11'],
			[78,'Stairs(Besides Lecture Theatre 1.1)'],
			[79,'Lecture Theatre 1.1'],
			[60,'Water Vending'],
			[68,'Byte Cafe'],
			[72,'Stairs(Besides Byte Cafe)'],
			[82,'LF6'],
			[84,'LF5'],
			[87,'Disabled LIFT(Besides LF7 Research Lab)'],
			[88,'Stairs(Besides LF7 Research Lab)'],
			[89,'LF8 Quiet Lab'],
			[103,'LF7 Research Lab'],
			[101,'Male Toilet'],
			[98,'Female Toilet'],
			[95,'Disabled Lift(Besides LF1 Research Lab)'],
			[90,'LF1 Research Lab'],
			[93,'Stairs(Besides LF1 Research Lab)']
		],
		[
			[0,'1.19 Mercury'],
			[9,'1.18B Atlas 2'],
			[7,'1.18A Atlas 1'],
			[33,'1.17 Research Lab'],
			[37,'1.14'],
			[39,'1.15'],
			[40,'1.12 Quiet Area'],
			[34,'1.10 Meeting Room'],
			[42,'1.8 Computer Cluster'],
			[45,'Bridge to IT Building Level 4'],
			[47,'Lecture Theatre 1.5'],
			[50,'Lecture Theatre 1.4'],
			[53,'Lecture Theatre 1.3'],
			[63,'Stairs to Lower First & Ground Floors(Besides LF1)'],
			[65,'Stairs to 2nd Floor(Besides LF1)'],
			[64,'LF1'],
			[68,'Disabled Lift'],
			[71,'Entrance(Elevated Walkway)'],
			[73,'Rear Entrance to Lecture Theatre 1.1'],
			[78,'Lecture Theatre 1.1'],
			[76,'Stairs to Lower First Floor(Besides Lecture Theatre 1.1)'],
			[81,'Courtyard'],
			[86,'Turing Lounge'],
			[26,'1.23 Senior Common Room'],
			[28,'1.24'],
			[25,'1.24A'],
			[20,'1.25'],
			[11,'1.20'],
			[15,'Female Toilet'],
			[13,'Disabled Toilet'],
			[19,'Male Toilet'],
			[22,'LIFT'],
			[24,'Stairs to Lower First & Ground Floors(Besides LIFT)'],
			[90,'Stairs to 2nd Floor(Besides 1.20 Room)']
		],
		[]
	];

	var points = [
		[
			[1080,285],//0
			[1080,500],//1
			[1150,500],//2
			[1150,460],//3
			[1150,400],//4
			[1260,460],//5
			[1325,500],//6
			[1325,870],//7
			[1395,870],//8
			[1270,870],//9
			[1325,1300],//10
			[1500,1300],//11
			[1500,1220],//12
			[1610,1300],//13
			[1610,1000],//14
			[1850,1000],//15
			[1850,1165],//16
			[2150,1165],//17
			[2150,1300],//18
			[1795,1300],//19
			[1795,1360],//20
			[1715,1300],//21
			[1715,1360],//22
			[1610,1400],//23
			[1565,1400],//24
			[1610,1530],//25
			[1385,1530],//26
			[1385,1450],//27
			[1435,1450],//28
			[1325,1450],//29
			[1325,1335],//30
			[1460,1335],//31
			[1325,1530],//32
			[1325,1810],//33
			[1385,1810],//34
			[1385,1865],//35
			[1300,1865],//36
			[1450,1865],//37
			[1450,2030],//38
			[1450,1820],//39
			[1535,1865],//40
			[1535,1930],//41
			[1610,1865],//42
			[1610,1930],//43
			[1675,1865],//44
			[1675,1930],//45
			[1750,1865],//46
			[1750,1930],//47
			[1905,1865],//48
			[1905,1930],//49
			[1955,1865],//50
			[1955,1930],//51
			[2150,1865],//52
			[2150,1905],//53
			[2070,1905],//54
			[2220,1905],//55
			[2220,1865],//56
			[2150,1725],//57
			[2220,1725],//58
			[2150,1680],//59
			[2220,1680],//60
			[2150,1435],//61
			[2090,1435],//62
			[2105,1725],//63
			[2105,1670],//64
			[1840,1725],//65
			[1840,1530],//66
			[1565,1530],//67
			[1565,1800],//68
			[1715,1230]//69
		],
		[
			[1040,410],//0
			[1040,470],//1
			[1210,470],//2
			[1210,290],//3
			[1165,290],//4
			[1165,355],//5
			[1250,290],//6
			[1250,230],//7
			[1165,230],//8
			[1380,290],//9
			[1380,230],//10
			[1510,290],//11
			[1510,230],//12
			[1645,290],//13
			[1645,230],//14
			[1715,290],//15
			[1770,290],//16
			[1770,230],//17
			[1900,290],//18
			[1900,230],//19
			[2030,290],//20
			[2030,230],//21
			[2080,290],//22
			[2170,290],//23
			[2080,365],//24
			[2160,365],//25
			[2080,425],//26
			[1985,425],//27
			[1985,350],//28
			[1985,480],//29
			[2050,480],//30
			[1940,480],//31
			[1940,590],//32
			[1775,590],//33
			[1775,660],//34
			[1775,750],//35
			[1990,660],//36
			[1990,750],//37
			[1715,660],//38
			[1665,660],//39
			[1665,550],//40
			[1515,550],//41
			[1515,750],//42
			[1715,750],//43
			[1715,880],//44
			[1440,880],//45
			[1440,1140],//46
			[1715,1140],//47
			[1715,980],//48
			[1595,980],//49
			[1715,940],//50
			[1880,940],//51
			[1880,1190],//52
			[2085,1190],//53
			[2085,1295],//54
			[2000,1295],//55
			[1715,1295],//56
			[1715,1330],//57
			[1630,1330],//58
			[1630,1420],//59
			[1630,1460],//60
			[1590,1420],//61
			[1590,1475],//62
			[1530,1475],//63
			[1345,1475],//64
			[1345,1140],//65
			[1345,1545],//66
			[1530,1545],//67
			[1630,1545],//68
			[1630,1585],//69
			[1715,1585],//70
			[1715,1640],//71
			[1650,1640],//72
			[2000,1640],//73
			[2000,1475],//74
			[2080,1475],//75
			[2080,1565],//76
			[2065,1640],//77
			[2165,1640],//78
			[2065,1710],//79
			[1715,1735],//80
			[1665,1735],//81
			[1665,1800],//82
			[1580,1735],//83
			[1580,1800],//84
			[1485,1735],//85
			[1485,1785],//86
			[1485,1825],//87
			[1355,1785],//88
			[1715,2040],//89
			[980,2040],//90
			[980,1735],//91
			[860,1735],//92
			[860,1665],//93
			[1060,1735],//94
			[1060,1705],//95
			[1100,1735],//96
			[1100,1805],//97
			[1200,1805],//98
			[1190,1735],//99
			[1190,1775],//100
			[1290,1775],//101
			[1345,1735],//102
			[1430,2040]//103
		],
		[
			[1070,275],//0
			[1300,275],//1
			[1300,205],//2
			[1410,205],//3
			[1410,240],//4
			[1410,565],//5
			[1300,565],//6
			[1165,565],//7
			[1300,370],//8
			[1165,370],//9
			[1515,565],//10
			[1515,450],//11
			[1570,565],//12
			[1570,500],//13
			[1620,565],//14
			[1620,500],//15
			[1700,565],//16
			[1730,565],//17
			[1730,430],//18
			[1600,430],//19
			[1730,370],//20
			[1820,430],//21
			[1820,370],//22
			[1895,430],//23
			[1895,320],//24
			[1895,520],//25
			[1700,685],//26
			[1770,685],//27
			[1770,515],//28
			[1550,685],//29
			[1410,685],//30
			[1410,715],//31
			[1230,715],//32
			[1230,750],//33
			[1230,1100],//34
			[1410,1100],//35
			[1080,750],//36
			[1080,1020],//37
			[1080,1070],//38
			[1150,1070],//39
			[1080,1140],//40
			[1080,1350],//41
			[1185,1350],//42
			[1185,1575],//43
			[1155,1575],//44
			[930,1575],//45
			[1155,1650],//46
			[1155,1825],//47
			[1155,1995],//48
			[1345,1995],//49
			[1345,1825],//50
			[1345,1650],//51
			[1375,1650],//52
			[1375,1825],//53
			[1375,1995],//54
			[1575,1995],//55
			[1575,1730],//56
			[1625,1730],//57
			[1625,1530],//58
			[1410,1530],//59
			[1410,1575],//60
			[1375,1575],//61
			[1345,1575],//62
			[1770,1730],//63
			[1770,1860],//64
			[1845,1730],//65
			[1770,1530],//66
			[1845,1530],//67
			[1845,1670],//68
			[1960,1530],//69
			[1960,1830],//70
			[1960,2000],//71
			[2305,1830],//72
			[2350,1830],//73
			[2305,1675],//74
			[2305,1630],//75
			[2390,1630],//76
			[2570,1675],//77
			[2570,1815],//78
			[2570,1980],//79
			[2305,1980],//80
			[1770,1060],//81
			[1770,820],//82
			[1475,820],//83
			[1475,725],//84
			[1550,725],//85
			[1960,1060],//86
			[1960,820],//87
			[1980,820],//88
			[1980,240],//89
			[1410,430]//90
		],
		[]
	];

	var graph = [
		[
			[1],//0
			[0,2,6],//1
			[1,3,4,6],//2
			[2,4,5],//3
			[2,3],//4
			[3],//5
			[1,2,7,10,29,30,32,33],//6
			[6,8,9,10,29,30,32,33],//7
			[7,9],//8
			[7,8],//9
			[6,7,11,13,18,19,21,29,30,32,33],//10
			[10,12,13,18,19,21],//11
			[11],//12
			[10,11,14,18,19,21,23,25,42,43],//13
			[13,15,23,25,42,43],//14
			[14,16],//15
			[15,17],//16
			[16,18,52,53,57,59,61],//17
			[10,11,13,17,19,21,52,53,57,59,61],//18
			[10,11,13,18,20,21],//19
			[19],//20
			[10,11,13,18,19,22,69],//21
			[21,69],//22
			[13,14,24,25,42,43],//23
			[23],//24
			[13,14,23,26,66,67,42,43],//25
			[25,27,34,35,66,67],//26
			[26,28,29,34,35],//27
			[27,29],//28
			[6,7,10,27,28,30,32,33],//29
			[6,7,10,29,31,32,33],//30
			[30],//31
			[6,7,10,29,30,33],//32
			[6,7,10,29,30,32,34],//33
			[26,27,33,35],//34
			[26,27,34,36,37],//35
			[35,37],//36
			[35,36,38,39],//37
			[37,39],//38
			[37,38],//39
			[41,42,44,46,48,50,52,56],//40
			[40],//41
			[13,14,23,25,40,43,44,46,48,50,52,56],//42
			[13,14,23,25,42],//43
			[40,42,45,46,48,50,52,56],//44
			[44],//45
			[40,42,44,47,48,50,52,56],//46
			[46],//47
			[40,42,44,46,49,50,52,56],//48
			[48],//49
			[40,42,44,46,48,51,52,56],//50
			[50],//51
			[17,18,40,42,44,46,48,50,53,56,57,59,61],//52
			[17,18,52,54,55,57,59,61],//53
			[53,55],//54
			[53,54],//55
			[40,42,44,46,48,50,52],//56
			[17,18,52,53,58,59,61,63,65],//57
			[57,63,65],//58
			[17,18,52,53,57,60,61],//59
			[59],//60
			[17,18,52,53,57,59,62],//61
			[61],//62
			[57,58,64,65],//63
			[63],//64
			[57,58,63,66],//65
			[25,26,65,67],//66
			[25,26,66,68],//67
			[67],//68
			[21,22],//69
		],
		[
			[1],//0
			[0,2],//1
			[1,3],//2
			[2,4,6,9,11,13,15,16,18,20,22,23],//3
			[3,5,6,9,11,13,15,16,18,20,22,23],//4
			[4],//5
			[3,4,7,9,11,13,15,16,18,20,22,23],//6
			[6,8],//7
			[7],//8
			[3,4,6,10,11,13,15,16,18,20,22,23],//9
			[9],//10------
			[3,4,6,9,12,13,15,16,18,20,22,23],//11
			[11],//12
			[3,4,6,9,11,14,15,16,18,20,22,23],//13
			[13],//14
			[3,4,6,9,11,13,16,18,20,22,23,38,43,44,47,48,50,56,57,70,71,80,89],//15
			[3,4,6,9,11,13,15,17,18,20,22,23],//16
			[16],//17
			[3,4,6,9,11,13,15,16,19,20,22,23],//18
			[18],//19
			[3,4,6,9,11,13,15,16,18,21,22,23],//20
			[20],//21-----
			[3,4,6,9,11,13,15,16,18,20,23,24,26],//22
			[3,4,6,9,11,13,15,16,18,20,22],//23
			[22,25,26],//24
			[24],//25
			[22,24,27],//26
			[26,28,29],//27
			[27,29],//28
			[27,28,30,31],//29
			[29,31],//30
			[29,30,32],//31
			[31,33],//32
			[32,34,35],//33
			[33,35,36,38,39],//34
			[33,34],//35
			[34,37,38,39],//36
			[36],//37
			[15,34,36,39,43,44,47,48,50,56,57,70,71,80,89],//38
			[34,36,38,40],//39
			[39,41],//40
			[40,42],//41
			[41,43],//42
			[15,38,42,44,47,48,50,56,57,70,71,80,89],//43----
			[15,38,43,45,47,48,50,56,57,70,71,80,89],//44
			[44,46],//45
			[45,47,65],//46
			[15,38,43,44,46,48,50,56,57,65,70,71,80,89],//47
			[15,38,43,44,47,49,50,56,57,70,71,80,89],//48
			[48],//49
			[15,38,43,44,47,48,51,56,57,70,71,80,89],//50
			[50,52],//51
			[51,53],//52
			[52,54],//53
			[53,55,56],//54
			[54,56,73,74],//55
			[15,38,43,44,47,48,50,54,55,57,70,71,80,89],//56
			[15,38,43,44,47,48,50,56,58,70,71,80,89],//57
			[57,59,60],//58
			[58,60,61],//59
			[58,59],//60
			[59,62],//61
			[61,63,64],//62
			[62,64,67],//63
			[62,63,65,66,102],//64
			[46,47,64,66,102],//65
			[64,65,67,68,102],//66
			[63,66,68],//67
			[66,67,69],//68
			[68,70],//69
			[15,38,43,44,47,48,50,56,57,69,71,80,89],//70
			[15,38,43,44,47,48,50,56,57,70,72,73,77,78,80,89],//71
			[71,73,77,78],//72
			[55,71,72,74,77,78],//73
			[55,73,75],//74
			[74,76],//75
			[75],//76
			[71,72,73,78,79],//77
			[71,72,73,77],//78
			[77],//79
			[15,38,43,44,47,48,50,56,57,70,71,81,83,85,89,91,92,94,96,99,102],//80
			[80,82,83,85,91,92,94,96,99,102],//81
			[81],//82
			[80,81,84,85,91,92,94,96,99,102],//83
			[83],//84
			[80,81,83,86,87,91,92,94,96,99,102],//85
			[85,87,88],//86
			[85,86],//87
			[86],//88
			[15,38,43,44,47,48,50,56,57,70,71,80,90,103],//89
			[89,91,103],//90
			[80,81,83,85,90,92,94,96,99,102],//91
			[80,81,83,85,91,93,94,96,99,102],//92
			[92],//93
			[80,81,83,85,91,92,95,96,99,102],//94
			[94],//95
			[80,81,83,85,91,92,94,97,99,102],//96
			[96,98],//97
			[97],//98
			[80,81,83,85,91,92,94,96,100,102],//99
			[99,101],//100
			[100],//101
			[64,65,66,80,81,83,85,91,92,94,96,99],//102
			[89,90],//103
		],
		[
			[1],//0
			[0,2,6,8],//1
			[1,3,6,8],//2
			[2,4,5,30,31,35,59,60,90],//3
			[3,5,30,31,35,59,60,89,90],//4
			[3,4,6,7,10,12,14,16,17,30,31,35,59,60,90],//5
			[1,2,5,7,8,10,12,14,16,17],//6
			[5,6,10,12,14,16,17],//7
			[1,2,6,9],//8
			[8],//9
			[5,6,7,11,12,14,16,17],//10
			[10],//11
			[5,6,7,10,13,14,16,17],//12
			[12],//13
			[5,6,7,10,12,15,16,17],//14
			[14],//15
			[5,6,7,10,12,14,17,26],//16
			[5,6,7,10,12,14,16,18,20],//17
			[17,19,20,21,23],//18
			[18,21,23],//19
			[17,18],//20
			[18,19,22,23],//21
			[21],//22
			[18,19,21,24,25],//23
			[23,25],//24
			[23,24],//25
			[16,27,29,30],//26
			[26,28,29,30],//27
			[27],//28
			[26,27,30,85],//29
			[3,4,5,26,27,29,31,35,59,60,90],//30
			[3,4,5,30,32,35,59,60,90],//31
			[31,33,34],//32
			[32,34,36],//33
			[32,33,35],//34
			[3,4,5,30,31,34,59,60,90],//35
			[33,37,38,40,41],//36
			[36,38,40,41],//37
			[36,37,39,40,41],//38
			[38],//39
			[36,37,38,41],//40
			[36,37,38,40,42],//41
			[41,43],//42
			[42,44,45,60,61,62],//43
			[43,45,46,47,48,60,61,62],//44
			[43,44,60,61,62],//45
			[44,47,48,51,52],//46
			[44,46,48],//47
			[44,46,47,49,54,55],//48
			[48,50,51,54,55,62],//49
			[49,51,62],//50
			[46,49,50,52,62],//51
			[46,51,53,54,61],//52
			[52,54,61],//53
			[48,49,52,53,55,61],//54-------
			[48,49,54,56],//55
			[55,57,63,65],//56
			[56,58,63,65],//57
			[57,59,66,67,69],//58
			[3,4,5,30,31,35,58,60,66,67,69,90],//59
			[3,4,5,30,31,35,43,44,45,59,61,62,90],//60
			[43,44,45,52,53,54,60,62],//61
			[43,44,45,49,50,51,60,61],//62
			[56,57,64,65,66,81,82],//63
			[63,66,81,82],//64
			[56,57,63,67,68],//65
			[58,59,63,64,67,69,81,82],//66
			[58,59,65,66,68,69],//67
			[65,67],//68
			[58,59,66,67,70,71,86,87],//69
			[69,71,72,73,86,87],//70
			[69,70,86,87],//71
			[70,73,74,75,80],//72
			[70,72],//73
			[72,75,77,80],//74
			[72,74,76,80],//75
			[75],//76
			[74,78,79],//77
			[77,79],//78
			[77,78,80],//79
			[72,74,75,79],//80
			[63,64,66,82,86],//81
			[63,64,66,81,83],//82
			[82,84],//83
			[83,85],//84
			[29,84],//85
			[69,70,71,81,87],//86
			[69,70,71,86,88],//87
			[87,89],//88
			[4,88],//89
			[3,4,5,30,31,35,59,60],//90
		],
		[]
	];
/*
	var graph = new Array(4);
	var distr = '';
	for (var i = 0; i < points.length; i++) {
		distr += '		[<br>';
		graph[i] = new Array(points[i].length);
		for (var j = 0; j < points[i].length; j++) {
			distr += '			[';
			for (var k = 0; k < points[i].length; k++) {
				if((points[i][j][0] == points[i][k][0] || points[i][j][1] == points[i][k][1])
					&& j != k){
					if(graph[i][j] == undefined){
						graph[i][j] = new Array();
						distr += k;
					}
					else{
						distr += ','+k;
					}
					graph[i][j].push(k);
				}
			}
			distr += '],//'+j+'<br>';
		}
		distr += '		],<br>';
	}*/
	//console.log(ggraph);
	//document.getElementById('display').innerHTML = distr;

	function changeFloor() {
		removeLines();
		if(document.getElementById('srm')){
			document.getElementById('header').removeChild(document.getElementById('srml'));
			document.getElementById('header').removeChild(document.getElementById('srm'));
			document.getElementById('header').removeChild(document.getElementsByTagName('br')[0]);
			document.getElementById('header').removeChild(document.getElementsByTagName('br')[0]);
		}
		if(document.getElementById('erm')){
			document.getElementById('header').removeChild(document.getElementById('erml'));
			document.getElementById('header').removeChild(document.getElementById('erm'));
		}
		var iml = document.getElementById('imgLoader');
		iml.src = '';
		if(document.getElementById('flr').value != ''){
			floorNum = parseInt(document.getElementById('flr').value);
			document.getElementById('bdy').removeChild(iml);
			iml = document.createElement('img');
			iml.id = 'imgLoader';
			iml.src = img[floorNum];
			document.getElementById('bdy').appendChild(iml);
			iml.onload = function () {
				var elementHeight = heightCrossBrowser(iml);
				pathScale = elementHeight / imgScale;// imgScale = 600
				iml.style.height = imgScale+'px';
				console.log('Current Image Height:'+elementHeight);
			}
			console.log('Current Path Scale:'+pathScale);
			var array0 = new Array(graph[floorNum].length);
			array0.fill(true);
			drawIsRunning = new Array(graph[floorNum].length);
			drawIsRunning.fill(array0);

			var srml = document.createElement('label');
			srml.innerHTML = 'Select Start Position: ';
			srml.for = 'srm';
			srml.id = 'srml';
			document.getElementById('header').appendChild(srml);
			var srm = document.createElement('select');
			srm.id = 'srm';
			srm.addEventListener('change', showPath);
			var foptn = document.createElement('option');
			foptn.value = '';
			foptn.innerHTML = 'Select Start Position';
			srm.appendChild(foptn);
			document.getElementById('header').appendChild(srm);
			document.getElementById('header').appendChild(document.createElement('br'));
			document.getElementById('header').appendChild(document.createElement('br'));
			var erml = document.createElement('label');
			erml.innerHTML = 'Select Ending Position: ';
			erml.for = 'erm';
			erml.id = 'erml';
			document.getElementById('header').appendChild(erml);
			var erm = document.createElement('select');
			erm.id = 'erm';
			erm.addEventListener('change', showPath);
			foptn = document.createElement('option');
			foptn.value = '';
			foptn.innerHTML = 'Select Ending Position';
			erm.appendChild(foptn);
			document.getElementById('header').appendChild(erm);
			for (var i = 0, len = menu[floorNum].length; i < len; i++) {
				var optn = document.createElement('option');
				optn.innerHTML = menu[floorNum][i][1];
				optn.value = menu[floorNum][i][0];
				srm.appendChild(optn);
				optn = document.createElement('option');
				optn.innerHTML = menu[floorNum][i][1];
				optn.value = menu[floorNum][i][0];
				erm.appendChild(optn);
			}
		}
		else{
			floorNum = '';
		}
	}

	function dijkstra(srmv, ermv) {
		var path = new Array(graph[floorNum].length),
			vist = new Array(graph[floorNum].length),
			nods = new Array(graph[floorNum].length);

		path.fill(-1);
		vist.fill(false);
		nods.fill(0);
		path[srmv] = -2;
		var fl = true;
		var nodeSteps = 0;
		while(fl){
			nodeSteps ++;
			fl = false;
			var resu = new Array();
			for (var i = 0; i < path.length; i++) {
				if(path[i] != -1 && !vist[i] && nods[i] < nodeSteps){
					vist[i] = true;
					for (var j = 0; j < graph[floorNum][i].length; j++) {
						//console.log(i+':'+graph[floorNum][i][j]+':'+path[graph[floorNum][i][j]]);
						if(path[graph[floorNum][i][j]] == -1){
							resu.push([pathDist(graph[floorNum][i][j],i),graph[floorNum][i][j],i]);
							//path[graph[floorNum][i][j]] = i;
							//nods[graph[floorNum][i][j]] = nodeSteps;
						}
					}
				}
				if(!vist[i]){
					fl = true;
				}
			}
			resu.sort(function(a, b){return a[0] - b[0]});
			for (var i = 0; i < resu.length; i++) {
				if(path[resu[i][1]] == -1){
					path[resu[i][1]] = resu[i][2];
					nods[resu[i][1]] = nodeSteps;
				}
			}
		}
		var res = new Array(), resi = ermv;
		while(path[resi] != -2){
			res.unshift(resi);
			resi = path[resi];
		}
		return res;
	}

	async function showPath() {
		removeLines();
		if(document.getElementById('srm').value != '' && document.getElementById('erm').value != ''){
			var srmv = parseInt(document.getElementById('srm').value),
				ermv = parseInt(document.getElementById('erm').value);
			//console.log(dijkstra(srmv,ermv));
			drawSLine(points[floorNum][srmv][0],points[floorNum][srmv][1],
				points[floorNum][srmv][0],points[floorNum][srmv][1]+5);
			straitLine_i ++;
			drawSLine(points[floorNum][ermv][0],points[floorNum][ermv][1],
				points[floorNum][ermv][0],points[floorNum][ermv][1]+5);
			straitLine_i ++;
			var res = dijkstra(srmv,ermv);
			if(res == []){
				console.log('failed');
			}
			else if(res.length > 1){
				console.log('successfull');
				res.unshift(srmv);
				console.log(res);
				//res[2] = shortify(res[2]);
				//console.log(res[2]);
				//console.log('----------------------'+arrayGr[29]);
				var array0 = new Array(graph[floorNum].length);
				array0.fill(true);
				drawIsRunning = new Array(graph[floorNum].length);
				drawIsRunning.fill(array0);
				drawIsRunning[srmv][ermv] = false;
				removeLines();
				for (var i = 1, len = res.length; i < len; i++) {
					if(drawIsRunning[srmv][ermv]){
						break;
					}
					drawSLine(
						points[floorNum][res[i-1]][0], points[floorNum][res[i-1]][1],
						points[floorNum][res[i]][0], points[floorNum][res[i]][1]
						);
					straitLine_i ++;
					await sleep(pathDist(res[i], res[i-1])*2);
				}
			}
		}
		else{
			var array0 = new Array(graph[floorNum].length);
			array0.fill(true);
			drawIsRunning = new Array(graph[floorNum].length);
			drawIsRunning.fill(array0);
			removeLines();
		}
	}
	/*
	// mouse down handler
	function onMouseDown(evt) {
	  var mousex = event.clientX;//(event.clientX / window.innerWidth) * 2 - 1;
	  var mousey = event.clientY;//-(event.clientY / window.innerHeight) * 2 + 1;
	  //alert("X: "+mousex+"; Y: "+mousey);
	  //console.log("Mouse Clicked:: X: "+mousex+"; Y: "+mousey);
	  document.getElementById('display').innerHTML = "Mouse Clicked:: X: "+mousex+"; Y: "+mousey;
	}*/

</script>

</body>
</html>
